import{d as Ie,r as p,v as Pe,a as v,w as Oe,o as Ge,e as u,f as s,m as I,g as X,u as P,h as Z,t as r,j as S,F as C,i as M,n as Ue,k as Qe,l as c,s as Ve,_ as je}from"./index-BF0cp_aK.js";import{R as ze,g as ee,a as Ke}from"./resources-Dms7kciv.js";import{A as qe}from"./arrow-left-CW97Icst.js";import{T as Je}from"./trophy-KyBKJ274.js";const Xe={class:"arena-page"},Ze={class:"top-bar"},et={class:"resource-pill"},tt={class:"text-right"},at={class:"text-[10px] uppercase tracking-[0.3em] text-muted-foreground"},st={class:"text-lg font-bold"},ot={class:"intro-panel"},rt={class:"panel stats-panel"},nt={class:"stat-grid"},lt=["title"],it={class:"stat-label"},ut={class:"stat-value"},ct={class:"content-grid"},dt={class:"panel enemy-panel"},ht={class:"panel-header"},pt={class:"text-2xl font-semibold"},mt={class:"text-sm text-muted-foreground"},gt={class:"text-right text-xs text-muted-foreground"},yt={class:"text-lg font-bold text-foreground"},vt={class:"mt-4"},ft={class:"health-bar"},bt={class:"stat-grid mt-4"},xt=["title"],kt={class:"stat-label"},_t={class:"stat-value"},wt={class:"panel hand-panel"},St={class:"panel-header"},Ct={class:"text-xs text-muted-foreground"},Mt={class:"card-grid"},Et=["onClick"],At={class:"flex items-center justify-between"},$t={class:"text-base font-bold text-foreground"},Rt={class:"flex items-center gap-2"},Ht={class:"badge"},Bt={key:0,class:"badge badge-instant"},Tt={class:"text-xs text-muted-foreground"},Dt={class:"text-[11px] font-semibold text-muted-foreground"},Yt={key:0,class:"text-xs uppercase tracking-[0.3em] text-rose-300"},Lt={class:"panel log-panel"},Nt={class:"space-y-2 text-sm"},Wt={key:0,class:"overlay"},Ft={class:"overlay-card"},It={class:"grid gap-4 sm:grid-cols-2"},Pt=["onClick"],Ot={class:"text-base font-semibold text-foreground"},Gt={class:"text-sm text-muted-foreground"},Ut={key:1,class:"overlay"},Qt={class:"overlay-card text-center"},Vt={class:"text-xs font-semibold uppercase tracking-[0.4em] text-primary/80"},jt={class:"text-sm text-muted-foreground mt-2"},O=5,_=8,zt=3,H=20,te=5,ae=0,Kt=4,qt=10,Jt=3,B="warriorsChallenge",Xt="group inline-flex items-center gap-2 rounded-md border border-border bg-card/70 px-4 py-2 text-sm font-semibold text-foreground transition hover:bg-card focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-primary",Zt="group relative flex w-full flex-col gap-2 rounded-xl border border-border/60 bg-card/70 px-4 py-4 text-left transition hover:border-primary/60 hover:bg-card/90",ea=Ie({__name:"WarriorsChallenge",setup(ta){const se=Qe(),G=ze[B],T=p(ee(B)),E=()=>typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`id-${Math.random().toString(16).slice(2)}`,D=e=>{const t=[...e];for(let a=t.length-1;a>0;a-=1){const i=Math.floor(Math.random()*(a+1));[t[a],t[i]]=[t[i],t[a]]}return t},Y=[{name:"Heroic Strike",effect:"singleStrike",powerMultiplier:1.5,hitCount:1},{name:"Twin Lunge",effect:"doubleStrike",powerMultiplier:.9,hitCount:2},{name:"Blade Whirl",effect:"tripleStrike",powerMultiplier:.5,hitCount:3},{name:"Battle Salve",effect:"heal",powerMultiplier:1.5},{name:"Shield Wall",effect:"shield",powerMultiplier:1,instant:!0},{name:"War Hymn",effect:"boost",powerMultiplier:.5},{name:"Quick Draught",effect:"heal",powerMultiplier:.6,instant:!0},{name:"Guardian Pulse",effect:"shield",powerMultiplier:.6,instant:!0},{name:"Quick Attack",effect:"singleStrike",powerMultiplier:.75,hitCount:1,instant:!0}],oe={singleStrike:"Single Attack",doubleStrike:"Twin Attack",tripleStrike:"Flurry",heal:"Heal",shield:"Shield",boost:"Boost"},re=e=>{const t=Y.find(a=>a.name===e);if(!t)throw new Error(`Unknown card template: ${e}`);return{...t}},ne=["Heroic Strike","Heroic Strike","Twin Lunge","Blade Whirl","Battle Salve","Shield Wall","War Hymn","Quick Attack"].map(re),le=[{name:"Goblin Spearthrower",description:"Cowardly skirmisher pelting you from afar."},{name:"Orc Brute",description:"Heavy swings that batter your guard."},{name:"Crystal Wraith",description:"Siphons life if allowed to linger."},{name:"Frostbound Knight",description:"Well armored challenger with punishing ripostes."},{name:"Amber Drake",description:"Molten spit scorches armor clean off."},{name:"Warden Automaton",description:"Whirring blades and precise strikes."},{name:"Frost Revenant",description:"Steals warmth and resolve."},{name:"Arena Juggernaut",description:"Final challenger clad in iron plates."}],ie=le.slice(0,_).map((e,t)=>{const a=qt+t*Jt;let i=Math.min(Kt,Math.floor(a/5)),f=a-i,k=Math.max(2,Math.floor(f/2)),x=f-k;x<1&&(x=1,k=Math.max(2,f-x));const Fe=Math.max(10,x*10);return{name:e.name,description:e.description,strength:k,armor:i,health:Fe}}),l=p("ready"),m=p([]),g=p([]),h=p([]),w=p([]),d=p(null),A=p(0),U=p(0),Q=p(0),$=p([]),b=p([]),L=p(!1),o=Pe({strength:te,armor:ae,hp:H,maxHp:H,shield:0,pendingBoost:0}),ue=v(()=>h.value.length+m.value.length+g.value.length),V=v(()=>d.value),ce=v(()=>{var e;return((e=V.value)==null?void 0:e.name)??"No Foe"}),de=v(()=>{var e;return((e=V.value)==null?void 0:e.description)??""}),he=v(()=>d.value?Math.max(0,Math.round(d.value.hp/d.value.health*100)):0),pe=v(()=>h.value.length===0&&m.value.length===0&&g.value.length===0),me=e=>{switch(e.effect){case"singleStrike":case"doubleStrike":case"tripleStrike":return"border-orange-500/50 bg-gradient-to-b from-orange-500/20 to-orange-500/5";case"heal":case"shield":return"border-emerald-500/40 bg-gradient-to-b from-emerald-500/20 to-emerald-500/5";case"boost":return"border-sky-500/40 bg-gradient-to-b from-sky-500/20 to-sky-500/5";default:return""}},y={strength:"Damage dealt per attack before boosts.",health:"Damage you can take before defeat.",armor:"Flat damage reduction applied to each hit taken.",shield:"Temporary protection that absorbs hits before health.",boost:"Stored power bonus applied to your next card.",enemyStrength:"Damage the enemy deals before your armor and shield.",enemyHealth:"Enemy vitality. Reduce to zero to win.",enemyArmor:"Flat damage reduction applied to your attacks against the enemy."},ge=v(()=>[{key:"strength",label:"Strength",value:o.strength,tooltip:y.strength},{key:"health",label:"Health",value:`${o.hp} / ${o.maxHp}`,tooltip:y.health},{key:"armor",label:"Armor",value:o.armor,tooltip:y.armor},{key:"shield",label:"Shield",value:o.shield,tooltip:y.shield},{key:"boost",label:"Boost",value:`${Math.round(o.pendingBoost*100)}%`,tooltip:y.boost}]),ye=v(()=>{const e=d.value;return e?[{key:"enemyStrength",label:"Enemy Strength",value:e.strength,tooltip:y.enemyStrength},{key:"enemyHealth",label:"Enemy Health",value:`${e.hp} / ${e.health}`,tooltip:y.enemyHealth},{key:"enemyArmor",label:"Enemy Armor",value:e.armor,tooltip:y.enemyArmor}]:[{key:"enemyStrength",label:"Enemy Strength",value:"--",tooltip:y.enemyStrength},{key:"enemyHealth",label:"Enemy Health",value:"--",tooltip:y.enemyHealth},{key:"enemyArmor",label:"Enemy Armor",value:"--",tooltip:y.enemyArmor}]}),ve=e=>{const t=o.strength,a=Math.round(t*e.powerMultiplier);switch(e.effect){case"singleStrike":case"doubleStrike":case"tripleStrike":{const i=e.hitCount??1,f=a*i;return i>1?`${a} dmg x ${i} = ${f}`:`${f} damage`}case"heal":return`Restore ${a} health`;case"shield":return`Gain ${a} shield`;case"boost":return`Store +${Math.round(e.powerMultiplier*100)}% for your next card`;default:return""}},n=(e,t)=>{$.value=[{id:E(),tone:e,text:t},...$.value].slice(0,14)},j=e=>{const t=Math.round(e.powerMultiplier*100);switch(e.effect){case"singleStrike":case"doubleStrike":case"tripleStrike":{const a=e.hitCount??1;e.description=`${e.instant?"Instantly ":""}deal ${a} hit${a>1?"s":""} for ${t}% of your strength each.`;break}case"heal":e.description=`${e.instant?"Instantly h":"H"}eal ${t}% of your strength.`;break;case"shield":e.description=`${e.instant?"Instantly g":"G"}ain ${t}% of your strength as shield.`;break;case"boost":e.description=`Boost your next card by ${t}%.`;break;default:e.description=""}},z=e=>{const t={...e,id:E(),baseName:e.name,upgradeCount:0,description:""};return j(t),t},fe=()=>{m.value=D(ne.map(z)),g.value=[],h.value=[]},be=()=>{w.value=ie.slice(0,_)},xe=()=>{if(!m.value.length)return null;const e=m.value[m.value.length-1];return m.value=m.value.slice(0,-1),e},K=e=>{const t=[...h.value];for(let a=0;a<e;a+=1){!m.value.length&&g.value.length&&(m.value=D(g.value),g.value=[]);const i=xe();if(!i)break;t.push(i)}h.value=t},R=()=>{h.value.length>=O||K(O-h.value.length)},ke=()=>[...m.value,...g.value,...h.value],_e=e=>{g.value=[...g.value,e],n("system",`${e.name} is added to your discard pile.`)},we=()=>{const e=ke();if(!e.length)return;const t=e[Math.floor(Math.random()*e.length)];t.powerMultiplier=parseFloat((t.powerMultiplier*1.5).toFixed(2)),t.upgradeCount+=1,t.name=`${t.baseName}+${t.upgradeCount}`,j(t),n("system",`${t.name} surges with +50% effectiveness.`)},N=()=>{if(!w.value.length){d.value=null;return}const[e,...t]=w.value;w.value=t,d.value={...e,id:E(),hp:e.health},n("enemy",`${e.name} enters the arena: ${e.description}`)},Se=()=>{if(!d.value)return;const e=d.value;let t=Math.max(0,e.strength-o.armor);if(o.shield>0){const a=Math.min(o.shield,t);o.shield-=a,t-=a,a>0&&n("system",`Shield absorbs ${a} damage.`)}t>0?(o.hp=Math.max(0,o.hp-t),n("enemy",`${e.name} strikes for ${t} damage.`)):n("enemy",`${e.name} cannot pierce your defenses.`),o.hp<=0&&(n("system","You collapse under the assault. The challenge ends."),l.value="defeat")},W=e=>{const t=1+o.pendingBoost,a=e.powerMultiplier*t;return o.pendingBoost>0&&n("system",`Stored boost adds ${Math.round(o.pendingBoost*100)}% power.`),o.pendingBoost=0,a},Ce=(e,t)=>{if(!d.value){n("system","There is no enemy to strike.");return}const a=d.value,i=Math.max(0,Math.round(o.strength*W(e)));let f=0;for(let k=0;k<t;k+=1){const x=Math.max(0,i-a.armor);a.hp=Math.max(0,a.hp-x),f+=x}Q.value+=f,n("player",`${e.name} deals ${f} damage (${t} hit${t>1?"s":""}).`),a.hp<=0&&(n("player",`${a.name} falls.`),Be())},Me=e=>{const t=Math.max(0,Math.round(o.strength*W(e))),a=o.hp;o.hp=Math.min(o.maxHp,o.hp+t),n("player",`${e.name} restores ${o.hp-a} health.`)},Ee=e=>{const t=Math.max(0,Math.round(o.strength*W(e)));o.shield+=t,n("system",`${e.name} grants ${t} shield.`)},Ae=e=>{switch(e.effect){case"singleStrike":case"doubleStrike":case"tripleStrike":Ce(e,e.hitCount??1);break;case"heal":Me(e);break;case"shield":Ee(e);break;case"boost":o.pendingBoost+=e.powerMultiplier,n("system",`You store a ${Math.round(e.powerMultiplier*100)}% boost for the next card.`);break}!e.instant&&l.value==="playing"&&d.value&&Se()},$e=e=>{g.value=[...g.value,e]},Re=e=>{if(l.value!=="playing")return;const t=h.value.findIndex(i=>i.id===e);if(t===-1)return;const[a]=h.value.splice(t,1);U.value+=1,Ae(a),$e(a),l.value==="playing"&&(R(),F())},F=()=>{pe.value&&(n("system","You are out of cards. The challenge ends here."),l.value="defeat")},He=()=>{const e=[{label:"+1 Armor",description:"Reduce every incoming blow by one.",apply:()=>{o.armor+=1,n("system","Your armor is reinforced.")}},{label:"+1 Strength",description:"Increase the power of every card.",apply:()=>{o.strength+=1,n("system","Your strikes grow stronger.")}},{label:"+2 Health",description:"Raise max health and heal by two.",apply:()=>{o.maxHp+=2,o.hp=Math.min(o.maxHp,o.hp+2),n("system","You catch your breath (+2 health).")}},{label:"Gain Random Card",description:"Add a fresh card to your discard pile.",apply:()=>_e(z(Y[Math.floor(Math.random()*Y.length)]))},{label:"Empower Random Card",description:"Increase a random card's numbers by 50%.",apply:()=>we()}];b.value=D(e).slice(0,zt).map(t=>({...t,id:E()}))},Be=()=>{if(A.value+=1,d.value=null,A.value>=_){l.value="victory",n("system","You stand triumphant over the arena.");return}He(),l.value="reward"},Te=e=>{const t=b.value.find(a=>a.id===e);t&&(t.apply(),b.value=[],N(),R(),F(),l.value="playing")},De=()=>{b.value.length&&(b.value=[],n("system","You decline the arena's boons."),N(),R(),F(),l.value="playing")},q=()=>{l.value="ready",m.value=[],g.value=[],h.value=[],w.value=[],d.value=null,A.value=0,U.value=0,Q.value=0,o.strength=te,o.armor=ae,o.maxHp=H,o.hp=H,o.shield=0,o.pendingBoost=0,$.value=[],b.value=[],L.value=!1},J=()=>{q(),fe(),be(),K(O),N(),R(),l.value="playing",n("system","Warrior's Challenge begins. Play your cards wisely.")};Oe(()=>l.value,e=>{e==="playing"&&(T.value=ee(B)),e==="victory"&&!L.value&&(T.value=Ke(B),L.value=!0,Ve({title:"Challenge Conquered",description:`You clear the arena and earn a ${G.singular.toLowerCase()}.`,variant:"success"}))}),Ge(()=>{q()});const Ye=()=>se.push("/"),Le=v(()=>{switch(l.value){case"victory":return"Arena Mastered";case"defeat":return o.hp<=0?"You Fall":"Deck Exhausted";default:return"Warrior's Challenge"}}),Ne=v(()=>{switch(l.value){case"victory":return"Every foe lies broken. The crowd roars for your strength.";case"defeat":return o.hp<=0?"Medics drag you aside. Return once your wounds knit.":"Your satchel runs dry. Without cards, you must yield.";default:return"Ready to prove your mettle?"}}),We=v(()=>{switch(l.value){case"victory":return"Challenge Again";case"defeat":return"Try Another Run";default:return"Begin Challenge"}});return(e,t)=>(c(),u("div",Xe,[s("header",Ze,[s("button",{type:"button",class:I(Xt),onClick:Ye},[X(P(qe),{class:"h-4 w-4 transition-transform group-hover:-translate-x-0.5"}),t[0]||(t[0]=Z(" Return ",-1))]),s("div",et,[X(P(Je),{class:"h-5 w-5 text-accent"}),s("div",tt,[s("p",at,r(P(G).plural),1),s("p",st,r(T.value),1)])])]),s("section",ot,[t[1]||(t[1]=s("div",null,[s("p",{class:"text-xs font-semibold uppercase tracking-[0.3em] text-primary/70"},"Warrior's Challenge"),s("h1",{class:"mt-1 text-3xl font-bold tracking-tight text-foreground"},"Arena Deck Duel")],-1)),s("p",{class:"text-sm text-muted-foreground sm:max-w-xl"}," Strength fuels every card. Time your swings, mend between blows, and claim a single boon after each victory. Defeat "+r(_)+" foes before your deck runs dry. "),l.value==="ready"?(c(),u("button",{key:0,type:"button",class:"cta-button",onClick:J}," Begin Challenge ")):S("",!0)]),s("section",rt,[t[2]||(t[2]=s("header",{class:"panel-header"},[s("div",null,[s("p",{class:"text-xs uppercase tracking-[0.25em] text-muted-foreground"},"Your Stand"),s("h2",{class:"text-xl font-semibold text-foreground"},"Battle-readiness")])],-1)),s("div",nt,[(c(!0),u(C,null,M(ge.value,a=>(c(),u("div",{key:a.key,class:"stat-card",title:a.tooltip},[s("p",it,r(a.label),1),s("p",ut,r(a.value),1)],8,lt))),128))])]),s("div",ct,[s("section",dt,[s("header",ht,[s("div",null,[t[3]||(t[3]=s("p",{class:"text-xs uppercase tracking-[0.25em] text-muted-foreground"},"Current Foe",-1)),s("h2",pt,r(ce.value),1),s("p",mt,r(de.value),1)]),s("div",gt,[t[4]||(t[4]=Z(" Remaining ",-1)),s("p",yt,r(_-A.value)+" / "+r(_),1)])]),s("div",vt,[t[5]||(t[5]=s("p",{class:"text-xs font-semibold uppercase tracking-[0.3em] text-muted-foreground"},"Enemy Health",-1)),s("div",ft,[s("span",{class:"health-fill",style:Ue({width:`${he.value}%`})},null,4)])]),s("div",bt,[(c(!0),u(C,null,M(ye.value,a=>(c(),u("div",{key:a.key,class:"stat-card",title:a.tooltip},[s("p",kt,r(a.label),1),s("p",_t,r(a.value),1)],8,xt))),128))])]),s("section",wt,[s("header",St,[t[6]||(t[6]=s("div",null,[s("p",{class:"text-xs uppercase tracking-[0.25em] text-muted-foreground"},"Your Hand"),s("h2",{class:"text-xl font-semibold text-foreground"},"Play a card")],-1)),s("p",Ct,"Cards remaining: "+r(ue.value),1)]),s("div",Mt,[(c(!0),u(C,null,M(h.value,a=>(c(),u("button",{key:a.id,type:"button",class:I([Zt,me(a)]),onClick:i=>Re(a.id)},[s("div",At,[s("h3",$t,r(a.name),1),s("div",Rt,[s("span",Ht,r(oe[a.effect]),1),a.instant?(c(),u("span",Bt,"Instant")):S("",!0)])]),s("p",Tt,r(a.description),1),s("p",Dt,r(ve(a)),1)],10,Et))),128)),h.value.length?S("",!0):(c(),u("p",Yt,"Satchel empty."))])]),s("section",Lt,[t[7]||(t[7]=s("header",{class:"panel-header"},[s("p",{class:"text-xs uppercase tracking-[0.25em] text-muted-foreground"},"Battle Log"),s("p",{class:"text-xs text-muted-foreground"},"Latest events")],-1)),s("ul",Nt,[(c(!0),u(C,null,M($.value,a=>(c(),u("li",{key:a.id,class:I(["rounded-xl border px-3 py-2",[a.tone==="player"?"border-emerald-500/30 bg-emerald-500/10 text-emerald-200":a.tone==="enemy"?"border-rose-500/30 bg-rose-500/10 text-rose-200":"border-sky-500/30 bg-sky-500/10 text-sky-200"]])},r(a.text),3))),128))])])]),l.value==="reward"&&b.value.length?(c(),u("div",Wt,[s("div",Ft,[t[8]||(t[8]=s("p",{class:"text-xs font-semibold uppercase tracking-[0.4em] text-primary/80"},"Victory Reward",-1)),t[9]||(t[9]=s("h3",{class:"text-2xl font-bold text-foreground mt-2"},"Choose one boon",-1)),t[10]||(t[10]=s("p",{class:"text-sm text-muted-foreground"},"Each victory grants a single boon. Choose wisely.",-1)),s("div",It,[(c(!0),u(C,null,M(b.value,a=>(c(),u("button",{key:a.id,type:"button",class:"reward-card",onClick:i=>Te(a.id)},[s("p",Ot,r(a.label),1),s("p",Gt,r(a.description),1)],8,Pt))),128))]),s("button",{type:"button",class:"skip-link",onClick:De},"Skip reward")])])):S("",!0),l.value==="victory"||l.value==="defeat"?(c(),u("div",Ut,[s("div",Qt,[s("p",Vt,r(Le.value),1),s("p",jt,r(Ne.value),1),s("button",{type:"button",class:"cta-button mt-4",onClick:J},r(We.value),1)])])):S("",!0)]))}}),la=je(ea,[["__scopeId","data-v-806b5ce6"]]);export{la as default};
