import{c as A,d as Ve,r as T,a as v,o as Xe,b as Ue,e as u,f as n,g as w,u as k,h as j,t as c,F as S,i as C,n as $,j as I,k as Ke,l as d,m as ze,_ as Je}from"./index-BF0cp_aK.js";import{A as Ze}from"./arrow-left-CW97Icst.js";import{H as Qe}from"./hammer-CLcW-VtV.js";import{C as et}from"./compass-BQizYnIo.js";/**
 * @license lucide-vue-next v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=A("Clock3Icon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16.5 12",key:"1aq6pp"}]]);/**
 * @license lucide-vue-next v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=A("FlagIcon",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-vue-next v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=A("LoaderCircleIcon",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-vue-next v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=A("RouteIcon",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]),ot={class:"mx-auto flex max-w-6xl flex-col gap-6 px-4 py-6"},nt={class:"rounded-3xl border border-border/50 bg-card/70 p-6 shadow-[0_20px_80px_rgba(0,0,0,0.35)] backdrop-blur"},it={class:"flex flex-wrap items-center justify-between gap-4"},at={class:"flex flex-wrap items-center justify-end gap-3"},lt={class:"flex items-center gap-2 rounded-full border border-border/50 px-4 py-2 text-xs text-muted-foreground"},ut={class:"mt-4 rounded-2xl border border-border/40 bg-background/60 px-4 py-3 text-sm text-muted-foreground"},ct={class:"rounded-3xl border border-border/40 bg-card/70 p-6 shadow-[var(--shadow-game)]"},dt={class:"flex items-center justify-between"},pt={class:"flex items-center gap-3"},ft={class:"mt-5 grid gap-3 sm:grid-cols-2 lg:grid-cols-4"},mt={class:"flex items-center justify-between text-sm font-semibold text-white"},gt={class:"text-[11px] uppercase tracking-[0.3em] text-muted-foreground"},ht={class:"grid gap-6 lg:grid-cols-[2fr,1fr]"},xt={class:"rounded-3xl border border-border/40 bg-card/70 p-6 shadow-[var(--shadow-game)]"},bt={class:"flex flex-wrap items-center justify-between gap-3"},vt={class:"flex items-center gap-3"},yt={class:"text-xs text-muted-foreground"},_t={class:"mt-6 overflow-auto"},wt=["onClick"],kt={class:"text-[10px] font-semibold uppercase tracking-[0.3em] text-slate-200"},It={class:"text-xs font-semibold text-white"},Mt={key:0,class:"text-[10px] text-emerald-300"},Bt={key:1,class:"text-[10px] text-green-200"},St={key:2,class:"text-[10px] text-emerald-100"},Ct={key:3,class:"text-[10px] text-amber-200"},Rt={key:4,class:"mt-1 text-[10px] text-primary-foreground"},Et={class:"flex flex-col gap-6"},Tt={class:"rounded-3xl border border-border/40 bg-card/70 p-5"},jt={class:"flex items-center gap-3"},Ot={class:"text-xl font-semibold text-white"},Nt={key:0,class:"mt-4 space-y-4 text-sm text-muted-foreground"},Ft={class:"font-semibold text-white"},Ht={class:"font-semibold text-white"},$t={key:0},At={class:"rounded-2xl border border-border/30 bg-background/60 p-4 text-white"},Pt={class:"text-xs font-semibold uppercase tracking-[0.4em] text-muted-foreground"},Lt={class:"text-lg font-semibold"},qt={class:"text-sm text-muted-foreground"},Wt={key:0,class:"mt-3 space-y-2"},Yt={class:"space-y-1 text-sm"},Dt={key:1},Gt={class:"mt-3"},Vt={class:"mt-2 flex flex-wrap gap-2"},Xt={key:0,class:"text-xs text-muted-foreground"},Ut={class:"mt-3"},Kt={key:0,class:"mt-2"},zt={class:"flex items-center gap-2 text-xs"},Jt={class:"mt-2 h-2 rounded-full bg-border/40"},Zt={key:1,class:"text-xs text-muted-foreground"},Qt={class:"mt-4 flex flex-wrap gap-2"},er={class:"mt-3 text-xs text-muted-foreground"},tr={key:1},rr={class:"mt-3 space-y-3"},sr={class:"text-[11px] uppercase tracking-[0.3em] text-muted-foreground"},or={class:"mt-2 space-y-2"},nr={class:"flex items-center justify-between text-sm font-semibold"},ir=["onClick"],ar={class:"text-xs text-muted-foreground"},lr={class:"text-[11px] text-muted-foreground"},ur={key:0,class:"text-[11px] text-amber-300"},cr={key:1,class:"mt-4 text-sm text-muted-foreground"},dr={class:"rounded-3xl border border-border/40 bg-card/70 p-5 shadow-[var(--shadow-game)]"},pr={class:"flex items-center gap-3"},fr={class:"mt-4 space-y-3"},mr={key:0,class:"rounded-2xl border border-dashed border-border/40 p-4 text-sm text-muted-foreground"},gr={class:"flex flex-wrap items-center justify-between gap-2 text-white"},hr={class:"text-xs text-muted-foreground"},xr={class:"text-xs text-muted-foreground"},br={key:0,class:"text-white"},vr={key:1,class:"text-white"},yr={class:"mt-2 h-2 rounded-full bg-border/40"},X=14,U=12,O=3e4,K=500,ce=2e3,_r=35,wr=12,kr=9999,z=112,Ir=Ve({__name:"MountainKing",setup(Mr){const de=X*U,P=z/2,J=Math.sqrt(3)*P,y={logs:{label:"Logs",role:"raw"},boards:{label:"Boards",role:"refined",starting:20},stone:{label:"Stone",role:"raw",starting:20},skins:{label:"Skins",role:"raw",starting:5},ironOre:{label:"Iron Ore",role:"raw"},coal:{label:"Coal",role:"raw"},ironBars:{label:"Iron Bars",role:"refined"},pigs:{label:"Pigs",role:"raw"},grain:{label:"Grain",role:"raw"},flour:{label:"Flour",role:"refined"},bread:{label:"Bread",role:"food",note:"Food"},axes:{label:"Axes",role:"military",note:"Needed for warriors"},shields:{label:"Shields",role:"military",note:"Needed for warriors"},armor:{label:"Armor",role:"military",note:"Needed for warriors"},beer:{label:"Beer",role:"food",note:"Needed for warriors"},meat:{label:"Meat",role:"food"}},N=["logs","boards","stone","skins","ironOre","coal","ironBars","grain","flour","bread","pigs","meat","beer","axes","shields","armor"],g={townHall:{type:"townHall",name:"Mountain Keep",description:"Stores every resource needed by the realm.",category:"Capital",cost:{},buildable:!1},woodcutter:{type:"woodcutter",name:"Woodcutter",description:"Cuts nearby trees into logs.",category:"Forestry",cost:{boards:2},buildable:!0,process:{special:"woodcutter"}},forester:{type:"forester",name:"Forester",description:"Plants new groves to keep the saws fed.",category:"Forestry",cost:{boards:2},buildable:!0,process:{special:"forester"}},sawmill:{type:"sawmill",name:"Sawmill",description:"Turns logs into sturdy boards.",category:"Forestry",cost:{boards:5,stone:2},buildable:!0,process:{inputs:{logs:2},outputs:{boards:2}},inputBuffer:{logs:4}},mine:{type:"mine",name:"Mine",description:"Consumes food to pull stone, coal, or ore depending on the hill.",category:"Extraction",cost:{boards:10},buildable:!0,process:{special:"mine"},requirement:t=>!!t.hillResource,inputBuffer:{bread:2,meat:2}},ironSmelter:{type:"ironSmelter",name:"Iron Smelter",description:"Burns coal with ore to pour iron bars.",category:"Industry",cost:{boards:5,stone:2},buildable:!0,process:{inputs:{ironOre:1,coal:1},outputs:{ironBars:1}},inputBuffer:{ironOre:2,coal:2}},smithy:{type:"smithy",name:"Smithy",description:"Forms axes and shields for the warriors.",category:"Industry",cost:{boards:3,stone:5,ironBars:1},buildable:!0,process:{inputs:{boards:1,ironBars:1},outputs:{axes:1,shields:1}},inputBuffer:{boards:2,ironBars:2}},armorer:{type:"armorer",name:"Armorer",description:"Shapes armor from skins and iron bars.",category:"Industry",cost:{boards:3,stone:5,ironBars:1},buildable:!0,process:{inputs:{ironBars:1,skins:1},outputs:{armor:1}},inputBuffer:{ironBars:2,skins:2}},farm:{type:"farm",name:"Farm",description:"Sows grain around the tile and harvests it.",category:"Harvest",cost:{boards:8,stone:4},buildable:!0,process:{outputs:{grain:2}}},pigFarm:{type:"pigFarm",name:"Pig Farm",description:"Feeds grain to pigs.",category:"Harvest",cost:{boards:7,stone:3},buildable:!0,process:{inputs:{grain:1},outputs:{pigs:1}},inputBuffer:{grain:3}},butcher:{type:"butcher",name:"Butcher",description:"Turns pigs into meat and skins.",category:"Harvest",cost:{boards:5,stone:2},buildable:!0,process:{inputs:{pigs:1},outputs:{meat:1,skins:1}},inputBuffer:{pigs:2}},windmill:{type:"windmill",name:"Windmill",description:"Grinds grain into flour.",category:"Processing",cost:{boards:8,stone:3,skins:4},buildable:!0,process:{inputs:{grain:1},outputs:{flour:1}},inputBuffer:{grain:3}},bakery:{type:"bakery",name:"Bakery",description:"Bakes flour into bread.",category:"Processing",cost:{boards:3,stone:7},buildable:!0,process:{inputs:{flour:1},outputs:{bread:1}},inputBuffer:{flour:3}},brewery:{type:"brewery",name:"Brewery",description:"Brews grain into beer.",category:"Processing",cost:{boards:3,stone:7,ironBars:2},buildable:!0,process:{inputs:{grain:1},outputs:{beer:1}},inputBuffer:{grain:3}}},pe=Ke(),fe=()=>{pe.push("/")},{tiles:Z,capitalTileId:L}=_e(),Q=new Map,R=ke(Z),x=T(Z),M=T([]),E=T([]),q=T(L),f=T(null),h=T("Connect flags with roads to let workers haul resources (1s per hex)."),me=v(()=>{const t=R.maxX-R.minX+z*2,e=R.maxY-R.minY+J*2;return{width:`${t}px`,height:`${e}px`}}),ee={};for(const t of N){const e=y[t].starting??0;e>0&&(ee[t]=e)}const te=se("townHall",L,ee);M.value.push(te);const re=x.value.find(t=>t.id===L);re&&(re.buildingId=te.id);let F=null;Xe(()=>{F=window.setInterval(()=>{Pe(K),Oe(K)},K)}),Ue(()=>{F&&(window.clearInterval(F),F=null)});const b=v(()=>x.value.find(t=>t.id===q.value)??null),p=v(()=>!b.value||!b.value.buildingId?null:M.value.find(t=>{var e;return t.id===((e=b.value)==null?void 0:e.buildingId)})??null),W=v(()=>p.value?g[p.value.type]:null),ge=v(()=>p.value?H(p.value):{}),he=v(()=>p.value?E.value.filter(t=>{var e,s;return t.fromBuildingId===((e=p.value)==null?void 0:e.id)||t.toBuildingId===((s=p.value)==null?void 0:s.id)}):[]),xe=v(()=>{const t=new Map;return Object.values(g).filter(e=>e.buildable).forEach(e=>{t.has(e.category)||t.set(e.category,[]),t.get(e.category).push(e)}),Array.from(t.entries()).map(([e,s])=>({category:e,definitions:s}))}),be=v(()=>x.value.filter(t=>t.trees>0).length),ve=v(()=>x.value.filter(t=>t.hillResource).length),ye=v(()=>{const t=Object.fromEntries(N.map(e=>[e,0]));return M.value.forEach(e=>{Object.entries(e.flagInventory).forEach(([s,o])=>{o&&(t[s]+=o)}),e.construction.complete||Object.entries(e.construction.delivered).forEach(([s,o])=>{o&&(t[s]+=o)})}),t});function _e(){const t=[];for(let i=0;i<U;i+=1)for(let r=0;r<X;r+=1){const l=r-Math.floor(i/2),m=i;t.push({id:`${r}-${i}`,col:r,row:i,q:l,r:m,trees:0,hillResource:null,isCapital:!1,buildingId:null,forestStatus:null})}const e=Math.floor(X/2),s=Math.floor(U/2),o=`${e}-${s}`,a=t.find(i=>i.id===o);return a&&(a.isCapital=!0),Ie(t,o),Me(t,o),{tiles:t,capitalTileId:o}}function we(t,e){const s=P*(1.5*t),o=P*(Math.sqrt(3)*(e+t/2));return{x:s,y:o}}function ke(t){let e=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;return t.forEach(i=>{const r=we(i.q,i.r);Q.set(i.id,r),e=Math.min(e,r.x),s=Math.max(s,r.x),o=Math.min(o,r.y),a=Math.max(a,r.y)}),{minX:e,maxX:s,minY:o,maxY:a}}function _(t,e){return(Math.abs(t.q-e.q)+Math.abs(t.q+t.r-e.q-e.r)+Math.abs(t.r-e.r))/2}function Y(t,e,s){return t.filter(o=>_(o,e)<=s)}function Ie(t,e){for(let s=0;s<_r;s+=1){const o=t.filter(l=>l.id!==e&&!l.isCapital),a=o[Math.floor(Math.random()*o.length)];if(!a)continue;const i=1+Math.floor(Math.random()*2);Y(t,a,i).filter(l=>l.id!==e).forEach(l=>{l.trees=1})}}function Me(t,e){const s=t.find(r=>r.id===e),o=["stone","ironOre","coal"];if(s){const r=t.filter(m=>m.id!==e&&_(m,s)<=5),l=r[Math.floor(Math.random()*r.length)];l&&(l.hillResource="stone")}let a=t.filter(r=>r.hillResource).length,i=0;for(;a<wr&&i<500;){const r=t[Math.floor(Math.random()*t.length)];if(!r||r.id===e||r.hillResource){i+=1;continue}r.hillResource=o[Math.floor(Math.random()*o.length)],a+=1,i+=1}if(s&&!t.some(r=>r.hillResource==="stone"&&_(r,s)<=5&&r.id!==e)){const r=t.find(l=>l.id!==e&&_(l,s)<=5)??t[1];r&&(r.hillResource="stone")}}function se(t,e,s){const o=g[t],a={};return s&&Object.entries(s).forEach(([i,r])=>{r&&(a[i]=r)}),{id:D(t),type:t,tileId:e,flagInventory:a,construction:{delivered:{},complete:!o.buildable},processing:null,lastMessage:o.buildable?"Awaiting materials.":"Ready to direct logistics."}}function D(t){return`${t}-${Math.random().toString(36).slice(2,8)}`}function oe(t,e,s){t[e]=(t[e]??0)+s}function ne(t,e,s){const o=t[e]??0;if(o<s)return!1;const a=o-s;return a<=0?delete t[e]:t[e]=a,!0}function Be(t){q.value=t}function Se(t){const e=b.value;if(!e||e.isCapital){h.value="Choose a free tile away from the capital.";return}if(e.trees>0){h.value="That hex is still forested. Clear the tree before staking a claim.";return}if(e.buildingId){h.value="That tile already has a flag.";return}const s=g[t];if(s.requirement&&!s.requirement(e)){h.value=`${s.name} must be built on a matching hill.`;return}const o=se(t,e.id);M.value.push(o),e.buildingId=o.id,h.value=`${s.name} foundation marked. Deliver ${ie(s.cost)} to raise it.`}function ie(t){const e=Object.entries(t).map(([s,o])=>`${o} ${y[s].label}`);return e.length?e.join(" + "):"Free"}function G(t){return t?g[t.type].name:"Empty"}function B(t){return M.value.find(e=>e.id===t)}function Ce(t){return M.value.find(e=>e.tileId===t)}function H(t){const e=g[t.type],s={};return Object.entries(e.cost).forEach(([o,a])=>{const i=o,r=t.construction.delivered[i]??0;(a??0)-r>0&&(s[i]=(a??0)-r)}),s}function Re(t,e,s){if(!t.construction.complete&&(H(t)[e]??0)>0){t.construction.delivered[e]=(t.construction.delivered[e]??0)+s;const i=H(t);Object.keys(i).length===0&&(t.construction.complete=!0,t.lastMessage="Structure completed.",h.value=`${g[t.type].name} is now operational.`);return}oe(t.flagInventory,e,s)}function Ee(t){const e=g[t.type];if(!t.construction.complete)return Object.entries(H(t)).map(([o,a])=>({resource:o,amount:a??0,priority:10}));if(t.type==="townHall")return N.map(o=>({resource:o,amount:kr,priority:1}));if(!e.process)return[];const s=[];if(e.process.inputs&&Object.entries(e.process.inputs).forEach(([o,a])=>{var m;const i=o,r=((m=e.inputBuffer)==null?void 0:m[i])??(a??1)*2,l=t.flagInventory[i]??0;l<r&&s.push({resource:i,amount:r-l,priority:5})}),e.process.special==="mine"){const o=t.flagInventory.bread??0;o<2&&s.push({resource:"bread",amount:2-o,priority:5});const a=t.flagInventory.meat??0;a<2&&s.push({resource:"meat",amount:2-a,priority:4})}return s}function Te(t,e){var a,i,r;if(!t.construction.complete||t.type==="townHall")return 0;const s=g[t.type];if((a=s.inputBuffer)!=null&&a[e])return s.inputBuffer[e]??0;const o=((r=(i=s.process)==null?void 0:i.inputs)==null?void 0:r[e])??0;return o>0?o*2:0}function je(t){if(!t.construction.complete)return[];const e=[];return N.forEach(s=>{const o=t.flagInventory[s]??0;if(o<=0)return;const a=Te(t,s),i=o-a;i>0&&e.push({resource:s,amount:i})}),e}function ae(t,e){const s=je(t),o=Ee(e);if(!s.length||!o.length)return null;let a=null;return o.forEach(i=>{const r=s.find(l=>l.resource===i.resource);!r||r.amount<=0||(!a||i.priority>a.priority)&&(a={id:D("job"),from:t.id,to:e.id,resource:i.resource,priority:i.priority})}),a}function le(t){if(t.worker.status!=="idle")return;const e=B(t.fromBuildingId),s=B(t.toBuildingId);if(!e||!s)return;const o=ae(e,s),a=ae(s,e);let i=null;if(o&&a?i=o.priority>=a.priority?o:a:i=o??a??null,!i)return;const r=B(i.from);r&&ne(r.flagInventory,i.resource,1)&&(t.worker.job=i,t.worker.status="hauling",t.worker.direction=i.from===t.fromBuildingId?"forward":"backward",t.worker.progressMs=0,t.worker.durationMs=Math.max(1,t.distance)*ce)}function Oe(t){E.value.forEach(e=>{if(e.worker.status==="idle"){le(e);return}if(!e.worker.job){e.worker.status="idle";return}if(e.worker.progressMs+=t,e.worker.progressMs>=e.worker.durationMs){const s=B(e.worker.job.to);s&&Re(s,e.worker.job.resource,1),e.worker.job=null,e.worker.status="idle",e.worker.progressMs=0,le(e)}})}function Ne(t,e){const s=g[t.type],o=s.process;if(!e||!o)return null;switch(o.special){case"woodcutter":return Fe(e);case"forester":return He(e);case"mine":return $e(t,e);default:return Ae(t,s)}}function Fe(t){x.value.find(i=>i.id===t.id);const e=Y(x.value,t,3).filter(i=>i.trees>0&&i.forestStatus!=="cutting").sort((i,r)=>_(t,i)-_(t,r));if(e.length===0)return null;const s=e[0],o=_(t,s);return{label:"Felling trees",durationMs:O+o*4e3,outputs:{logs:1},onStart:()=>{s.forestStatus="cutting"},onComplete:()=>{s.trees=0,s.forestStatus=null}}}function He(t){const e=Y(x.value,t,2).filter(o=>o.trees===0&&!o.isCapital&&!o.buildingId&&o.forestStatus!=="planting");if(e.length===0)return null;const s=e[Math.floor(Math.random()*e.length)];return s.forestStatus="planting",{label:"Planting seedlings",durationMs:O,onComplete:()=>{s.trees=1,s.forestStatus=null}}}function $e(t,e){if(!e.hillResource)return null;const s=t.flagInventory.bread??0,o=t.flagInventory.meat??0;let a=null;return s>0?a="bread":o>0&&(a="meat"),a?{label:"Feeding miners",durationMs:O,inputs:{[a]:1},outputs:{[e.hillResource]:1}}:null}function Ae(t,e){const s=e.process;return!s||s.inputs&&Object.entries(s.inputs).some(([a,i])=>(t.flagInventory[a]??0)<(i??0))?null:{label:`Processing ${e.name}`,durationMs:s.durationMs??O,inputs:s.inputs,outputs:s.outputs}}function Pe(t){M.value.forEach(e=>{var s,o,a;if(e.construction.complete){if(!e.processing){const i=x.value.find(l=>l.id===e.tileId),r=Ne(e,i);if(!r)return;if(r.inputs){if(Object.entries(r.inputs).some(([m,V])=>(e.flagInventory[m]??0)<(V??0)))return;Object.entries(r.inputs).forEach(([m,V])=>{ne(e.flagInventory,m,V??0)})}(s=r.onStart)==null||s.call(r,e,i),e.processing={label:r.label,remainingMs:r.durationMs??O,durationMs:r.durationMs??O,intent:r},e.lastMessage=r.label;return}if(e.processing.remainingMs-=t,e.processing.remainingMs<=0){const i=x.value.find(r=>r.id===e.tileId);e.processing.intent.outputs&&Object.entries(e.processing.intent.outputs).forEach(([r,l])=>{oe(e.flagInventory,r,l??0)}),(a=(o=e.processing.intent).onComplete)==null||a.call(o,e,i,e.processing.intent),e.processing=null,e.lastMessage=`${g[e.type].name} completed a batch.`}}})}function Le(){if(!p.value){h.value="Select a building flag first.";return}if(f.value&&f.value.id===p.value.id){f.value=null;return}f.value=p.value,h.value=`${g[p.value.type].name} ready as road start. Choose the destination flag next.`}function qe(){if(!f.value||!p.value){h.value="Set both endpoints before connecting.";return}if(f.value.id===p.value.id){h.value="Select a different flag to connect.";return}if(E.value.some(a=>{var i,r,l,m;return a.fromBuildingId===((i=f.value)==null?void 0:i.id)&&a.toBuildingId===((r=p.value)==null?void 0:r.id)||a.toBuildingId===((l=f.value)==null?void 0:l.id)&&a.fromBuildingId===((m=p.value)==null?void 0:m.id)})){h.value="Those flags are already linked.";return}const e=x.value.find(a=>{var i;return a.id===((i=f.value)==null?void 0:i.tileId)}),s=x.value.find(a=>{var i;return a.id===((i=p.value)==null?void 0:i.tileId)});if(!e||!s)return;const o=Math.max(1,Math.round(_(e,s)));E.value.push({id:D("road"),fromBuildingId:f.value.id,toBuildingId:p.value.id,distance:o,worker:{status:"idle",direction:"forward",job:null,progressMs:0,durationMs:o*ce}}),h.value=`Road laid (${o} hexes). A courier is now assigned between the two flags.`,f.value=null}function We(){f.value=null}function Ye(t){return t!=null&&t.processing?Math.max(0,1-t.processing.remainingMs/t.processing.durationMs):0}function De(t){if(!t.buildingId)return!1;const e=B(t.buildingId);return!e||!e.construction.complete?!1:e.type==="farm"}function Ge(t){const e=Q.get(t.id);if(!e)return{};const s=e.x-R.minX+z,o=e.y-R.minY+J;return{left:`${s}px`,top:`${o}px`}}return(t,e)=>{var s,o,a,i;return d(),u("div",ot,[n("section",nt,[n("div",it,[e[2]||(e[2]=n("div",null,[n("p",{class:"text-xs font-semibold uppercase tracking-[0.4em] text-muted-foreground"},"Logistics sandbox"),n("h1",{class:"text-3xl font-bold text-white"},"Mountain King"),n("p",{class:"text-sm text-muted-foreground"}," 100 hexes, one capital, and every flag must be connected by hand before workers haul goods. ")],-1)),n("div",at,[n("button",{type:"button",class:"flex items-center gap-2 rounded-full border border-border/60 px-4 py-2 text-xs font-semibold uppercase tracking-[0.3em] text-white transition hover:border-primary hover:text-primary",onClick:fe},[w(k(Ze),{class:"h-4 w-4"}),e[0]||(e[0]=j(" Back to hub ",-1))]),n("div",lt,[w(k(tt),{class:"h-4 w-4"}),e[1]||(e[1]=j(" Processing takes 30s • 1s per hex on roads ",-1))])])]),n("p",ut,c(h.value),1)]),n("section",ct,[n("div",dt,[n("div",pt,[w(k(Qe),{class:"h-6 w-6 text-primary"}),e[3]||(e[3]=n("div",null,[n("p",{class:"text-xs font-semibold uppercase tracking-[0.4em] text-muted-foreground"},"Stockpile"),n("h2",{class:"text-xl font-semibold text-white"},"Capital Inventory")],-1))]),e[4]||(e[4]=n("p",{class:"text-xs text-muted-foreground"},"Town Hall absorbs every processed good before redistributing supplies.",-1))]),n("div",ft,[(d(),u(S,null,C(N,r=>n("div",{key:r,class:"rounded-2xl border border-border/40 bg-background/60 p-4"},[n("div",mt,[n("span",null,c(y[r].label),1),n("span",null,c(ye.value[r]??0),1)]),n("p",gt,c(y[r].role)+" "+c(y[r].note?`• ${y[r].note}`:""),1)])),64))])]),n("section",ht,[n("div",xt,[n("div",bt,[n("div",vt,[w(k(et),{class:"h-6 w-6 text-primary"}),e[5]||(e[5]=n("div",null,[n("p",{class:"text-xs font-semibold uppercase tracking-[0.45em] text-muted-foreground"},"Hex map"),n("h2",{class:"text-2xl font-semibold text-white"},"Settled Valley")],-1))]),n("div",yt,c(de)+" tiles · "+c(be.value)+" with trees · "+c(ve.value)+" hills ",1)]),n("div",_t,[n("div",{class:"hex-map",style:$(me.value)},[(d(!0),u(S,null,C(x.value,r=>(d(),u("button",{key:r.id,type:"button",class:ze(["hex-button",{"hex-selected":r.id===q.value,"hex-forest":r.trees>0,"hex-grain":De(r),"hex-forest-cutting":r.forestStatus==="cutting","hex-forest-planting":r.forestStatus==="planting","hex-hill":r.hillResource,"hex-capital":r.isCapital,"hex-has-building":r.buildingId}]),style:$(Ge(r)),onClick:l=>Be(r.id)},[n("div",kt,c(r.col)+","+c(r.row),1),n("div",It,c(r.isCapital?"Keep":G(Ce(r.id))),1),r.trees?(d(),u("div",Mt," Tree ")):r.forestStatus==="planting"?(d(),u("div",Bt," Planting ")):r.forestStatus==="cutting"?(d(),u("div",St," Clearing ")):I("",!0),r.hillResource?(d(),u("div",Ct,c(r.hillResource==="ironOre"?"Iron hill":`${r.hillResource} hill`),1)):I("",!0),r.buildingId?(d(),u("div",Rt,[w(k(ue),{class:"hex-flag-icon"})])):I("",!0)],14,wt))),128))],4)])]),n("div",Et,[n("div",Tt,[n("div",jt,[w(k(ue),{class:"h-5 w-5 text-primary"}),n("div",null,[e[6]||(e[6]=n("p",{class:"text-xs font-semibold uppercase tracking-[0.45em] text-muted-foreground"},"Selected tile",-1)),n("h2",Ot,c(b.value?`${b.value.col},${b.value.row}`:"None"),1)])]),b.value?(d(),u("div",Nt,[n("p",null,[e[7]||(e[7]=j(" Trees: ",-1)),n("span",Ft,c(b.value.trees),1),e[8]||(e[8]=j(" · Hill: ",-1)),n("span",Ht,c(b.value.hillResource?b.value.hillResource:"None"),1)]),p.value?(d(),u("div",$t,[n("div",At,[n("p",Pt,c((s=W.value)==null?void 0:s.category),1),n("h3",Lt,c((o=W.value)==null?void 0:o.name),1),n("p",qt,c((a=W.value)==null?void 0:a.description),1),p.value.construction.complete?(d(),u("div",Dt,[n("div",Gt,[e[10]||(e[10]=n("p",{class:"text-xs uppercase tracking-[0.3em] text-muted-foreground"},"Flag inventory",-1)),n("div",Vt,[(d(!0),u(S,null,C(Object.entries(p.value.flagInventory),([r,l])=>(d(),u("span",{key:r,class:"rounded-full border border-border/40 px-3 py-1 text-xs"},c(y[r].label)+": "+c(l),1))),128)),Object.keys(p.value.flagInventory).length===0?(d(),u("span",Xt," Empty flag ")):I("",!0)])]),n("div",Ut,[e[11]||(e[11]=n("p",{class:"text-xs uppercase tracking-[0.3em] text-muted-foreground"},"Processing",-1)),p.value.processing?(d(),u("div",Kt,[n("div",zt,[w(k(rt),{class:"h-4 w-4 animate-spin text-primary"}),j(" "+c(p.value.processing.label),1)]),n("div",Jt,[n("div",{class:"h-full rounded-full bg-primary",style:$({width:`${Math.round(Ye(p.value)*100)}%`})},null,4)])])):(d(),u("p",Zt,"Idle until inputs arrive."))])])):(d(),u("div",Wt,[e[9]||(e[9]=n("p",{class:"text-xs uppercase tracking-[0.3em] text-muted-foreground"},"Foundation needs",-1)),n("ul",Yt,[(d(!0),u(S,null,C(ge.value,(r,l)=>(d(),u("li",{key:l,class:"flex items-center justify-between"},[n("span",null,c(y[l].label),1),n("span",null,c(r),1)]))),128))])]))]),n("div",Qt,[n("button",{type:"button",class:"rounded-full border border-border/40 px-4 py-2 text-xs font-semibold uppercase tracking-[0.3em] text-white transition hover:border-primary hover:text-primary",onClick:Le},c(((i=f.value)==null?void 0:i.id)===p.value.id?"Anchored":"Set road start"),1),f.value&&f.value.id!==p.value.id?(d(),u("button",{key:0,type:"button",class:"rounded-full border border-primary/60 px-4 py-2 text-xs font-semibold uppercase tracking-[0.3em] text-primary transition hover:bg-primary/10",onClick:qe}," Connect to "+c(g[f.value.type].name),1)):I("",!0),f.value?(d(),u("button",{key:1,type:"button",class:"rounded-full border border-border/40 px-3 py-2 text-xs text-muted-foreground hover:text-white",onClick:We}," Clear anchor ")):I("",!0)]),n("div",er," Active roads: "+c(he.value.length),1)])):(d(),u("div",tr,[e[12]||(e[12]=n("p",{class:"text-xs uppercase tracking-[0.4em] text-muted-foreground"},"Plan a building",-1)),n("div",rr,[(d(!0),u(S,null,C(xe.value,r=>(d(),u("div",{key:r.category,class:"rounded-2xl border border-border/40 p-3"},[n("p",sr,c(r.category),1),n("div",or,[(d(!0),u(S,null,C(r.definitions,l=>(d(),u("div",{key:l.type,class:"rounded-xl border border-border/30 bg-background/70 p-3 text-white"},[n("div",nr,[n("span",null,c(l.name),1),n("button",{type:"button",class:"rounded-full border border-border/40 px-3 py-1 text-[10px] uppercase tracking-[0.3em] transition hover:border-primary hover:text-primary",onClick:m=>Se(l.type)}," Place ",8,ir)]),n("p",ar,c(l.description),1),n("p",lr,"Cost: "+c(ie(l.cost)),1),l.requirement?(d(),u("p",ur," Special: requires a matching tile (e.g., hill for mines). ")):I("",!0)]))),128))])]))),128))])]))])):(d(),u("p",cr,"Select a tile on the board to inspect or plan."))]),n("div",dr,[n("div",pr,[w(k(st),{class:"h-5 w-5 text-primary"}),e[13]||(e[13]=n("div",null,[n("p",{class:"text-xs font-semibold uppercase tracking-[0.4em] text-muted-foreground"},"Roads & couriers"),n("h2",{class:"text-xl font-semibold text-white"},"Flag connections")],-1))]),n("div",fr,[e[15]||(e[15]=n("p",{class:"text-xs text-muted-foreground"}," Every road hosts one worker who hauls goods between both flags. Without roads, construction sites starve. ",-1)),E.value.length===0?(d(),u("div",mr," No roads yet. Anchor a flag, select another, and connect them to assign a courier. ")):I("",!0),(d(!0),u(S,null,C(E.value,r=>(d(),u("div",{key:r.id,class:"rounded-2xl border border-border/30 bg-background/60 p-4 text-sm"},[n("div",gr,[n("span",null,c(G(B(r.fromBuildingId)))+" → "+c(G(B(r.toBuildingId))),1),n("span",hr,c(r.distance)+" hexes",1)]),n("p",xr,[e[14]||(e[14]=j(" Worker: ",-1)),r.worker.status==="hauling"?(d(),u("span",br," Carrying "+c(r.worker.job?y[r.worker.job.resource].label:"cargo"),1)):(d(),u("span",vr,"Idle"))]),n("div",yr,[n("div",{class:"h-full rounded-full bg-primary transition-all",style:$({width:r.worker.status==="hauling"?`${Math.min(100,Math.round(r.worker.progressMs/r.worker.durationMs*100))}%`:"0%"})},null,4)])]))),128))])])])])])}}}),Er=Je(Ir,[["__scopeId","data-v-c4f1423b"]]);export{Er as default};
