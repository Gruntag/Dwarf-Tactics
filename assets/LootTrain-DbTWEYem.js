import{c as $,d as vt,r as c,v as mt,a as _,o as yt,e as i,f as s,u,g as d,h as C,t as a,F as x,i as S,j as E,k as gt,l as r,m as ht,n as ft,s as kt,_ as bt}from"./index-Do8rNvoV.js";import{R as _t,g as Ct,a as Gt}from"./resources-Dms7kciv.js";import{A as xt}from"./arrow-left-CLjQ6WBA.js";import{T as St}from"./tram-front-BTxH15ut.js";import{C as J}from"./compass-B4Y2u2TA.js";import{Z as Y}from"./zap-BpuRM3eQ.js";/**
 * @license lucide-vue-next v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=$("AwardIcon",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-vue-next v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=$("HeartIcon",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-vue-next v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=$("MapIcon",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-vue-next v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=$("Repeat2Icon",[["path",{d:"m2 9 3-3 3 3",key:"1ltn5i"}],["path",{d:"M13 18H7a2 2 0 0 1-2-2V6",key:"1r6tfw"}],["path",{d:"m22 15-3 3-3-3",key:"4rnwn2"}],["path",{d:"M11 6h6a2 2 0 0 1 2 2v10",key:"2f72bc"}]]),Nt={class:"loot-page"},Bt={class:"top-bar"},Tt={class:"title-cluster"},Lt={class:"hero"},At={class:"resource-pill"},Et={class:"label"},$t={class:"value"},It={class:"stats-row"},Vt={class:"stat-card"},Dt={class:"value"},Pt={class:"sub"},Ot={class:"stat-card"},Ut={class:"value"},Ft={class:"sub"},jt={class:"stat-card"},Ht={class:"value"},zt={class:"sub"},Kt={class:"playfield"},Zt={class:"map-panel"},Jt={class:"panel-header"},Yt={class:"map-canvas"},Wt={class:"map-lines",viewBox:"0 0 100 100",preserveAspectRatio:"none"},qt=["x1","y1","x2","y2"],Qt=["onClick"],Xt={class:"map-footnotes"},te={class:"journey-panel"},ee={class:"bonus-summary"},se={class:"card-inventory"},oe={key:0,class:"empty"},ne={key:1},ae={class:"card-name"},le={class:"card-meta"},ie={class:"log-panel"},re={key:0,class:"overlay"},ue={class:"overlay-card"},ce={class:"draft-grid"},de=["onClick"],pe={class:"card-title"},ve={class:"card-body"},me={class:"card-tag"},ye={key:1,class:"overlay"},ge={class:"overlay-card"},he={class:"rest-grid"},fe={key:2,class:"overlay"},ke={key:3,class:"overlay"},be={class:"overlay-card"},j=15,q=5,M=9,_e=2,Ce=vt({__name:"LootTrain",setup(Ge){const Q=gt(),X=_t.lootTrain,H=c(Ct("lootTrain")),y=c([]),I=c(null),R=c(0),V=c(1),w=c([]),h=c(null),f=c(null),G=c("map"),z=c("Exhausted in the tunnels."),n=mt({grit:28,maxGrit:28,cargo:0,speed:1,luck:0}),k=c([]),K=c(0),D=[{key:"mithril-brakes",name:"Mithril Brakes",rarity:"common",focus:"train",description:"Step bonus: -1 grit travel cost (min 1).",step:{costReduction:1}},{key:"vault-ale",name:"Vault Ale",rarity:"common",focus:"grun",description:"Step bonus: +2 grit after traveling.",step:{gritGain:2}},{key:"cargo-net",name:"Cargo Net",rarity:"common",focus:"train",description:"Step bonus: +1 cargo.",step:{cargoGain:1}},{key:"glimmer-lantern",name:"Glimmer Lantern",rarity:"common",focus:"balanced",description:"Step bonus: +1 luck.",step:{luckGain:1}},{key:"thrumming-rails",name:"Thrumming Rails",rarity:"uncommon",focus:"train",description:"Step bonus: +1 speed and +1 cargo.",step:{speedGain:1,cargoGain:1}},{key:"heartforge-pulse",name:"Heartforge Pulse",rarity:"uncommon",focus:"grun",description:"Step bonus: +3 grit, +1 max grit immediately.",step:{gritGain:3},instant:{gritMax:1,grit:1}},{key:"starlode",name:"Starlode Cache",rarity:"uncommon",focus:"balanced",description:"Step bonus: +1 cargo and +1 luck.",step:{cargoGain:1,luckGain:1}},{key:"river-of-sparks",name:"River of Sparks",rarity:"rare",focus:"train",description:"Step bonus: -2 grit cost, +2 speed.",step:{costReduction:2,speedGain:2}},{key:"grim-determination",name:"Grim Determination",rarity:"rare",focus:"grun",description:"Step bonus: +4 grit. Immediately +3 max grit.",step:{gritGain:4},instant:{gritMax:3,grit:3}},{key:"vault-ledger",name:"Vault Ledger",rarity:"rare",focus:"balanced",description:"Step bonus: +1 cargo, +1 luck, +1 loot seal progress.",step:{cargoGain:1,luckGain:1,resourceBonus:1}},{key:"slag-chains",name:"Slag Chains",rarity:"common",focus:"train",description:"Step bonus: +2 cargo, -1 grit cost.",step:{cargoGain:2,costReduction:1}},{key:"ember-rations",name:"Ember Rations",rarity:"common",focus:"grun",description:"Step bonus: +1 grit, +1 luck.",step:{gritGain:1,luckGain:1}}],tt=D.reduce((t,e)=>(t[e.key]=e,t),{}),N=_(()=>y.value.find(t=>t.id===I.value)??null),B=_(()=>{const t=new Map,e=100/(j-1),o=100/(M-1);return y.value.forEach(l=>{t.set(l.id,{x:l.column*e,y:l.row*o})}),t}),et=_(()=>y.value.flatMap(t=>{const e=B.value.get(t.id);return e?t.connections.filter(o=>t.id.localeCompare(o)<0).map(o=>{const l=B.value.get(o);return l?{id:`${t.id}-${o}`,x1:e.x,y1:e.y,x2:l.x,y2:l.y}:null}).filter(Boolean):[]})),v=_(()=>k.value.reduce((t,e)=>(t.costReduction+=e.step.costReduction??0,t.gritGain+=e.step.gritGain??0,t.cargoGain+=e.step.cargoGain??0,t.speedGain+=e.step.speedGain??0,t.luckGain+=e.step.luckGain??0,t.resourceBonus+=e.step.resourceBonus??0,t),{costReduction:0,gritGain:0,cargoGain:0,speedGain:0,luckGain:0,resourceBonus:0})),Z=_(()=>Math.max(1,_e+R.value-v.value.costReduction)),P=_(()=>{const t=N.value;return t?new Set(t.connections):new Set}),O=(t,e,o)=>({id:crypto.randomUUID(),column:t,row:e,type:o,visited:t===0,resolved:t===0,connections:[]}),st=()=>Math.random()<.2?"camp":"loot",ot=t=>{for(let e=t.length-1;e>0;e-=1){const o=Math.floor(Math.random()*(e+1));[t[e],t[o]]=[t[o],t[e]]}return t},nt=()=>{const t=[],e=O(0,Math.floor(M/2),"start");t.push([e]);for(let l=1;l<j-1;l+=1){const g=[];for(let p=0;p<q;p+=1){const m=Math.random()*.6,A=Math.max(0,Math.min(M-1,Math.round((p+m)/(q-1)*(M-1))));g.push(O(l,A,st()))}t.push(g)}const o=O(j-1,Math.floor(M/2),"vault");t.push([o]);for(let l=0;l<t.length-1;l+=1){const g=t[l],p=t[l+1];g.forEach(m=>{const A=p.filter(b=>Math.abs(b.row-m.row)<=2);ot(A.length?[...A]:[...p]).slice(0,3).forEach(b=>{m.connections.includes(b.id)||m.connections.push(b.id),b.connections.includes(m.id)||b.connections.push(m.id)})})}y.value=t.flat(),I.value=e.id},T=t=>{w.value=[t,...w.value].slice(0,12)},U=()=>{const t=[];for(;t.length<3;){const e=D[Math.floor(Math.random()*D.length)];t.push(e)}h.value=t},at=t=>{t.instant&&(t.instant.gritMax&&(n.maxGrit+=t.instant.gritMax,n.grit+=t.instant.gritMax),t.instant.grit&&(n.grit=Math.min(n.maxGrit,n.grit+t.instant.grit)),t.instant.cargo&&(n.cargo+=t.instant.cargo))},lt=()=>{const t=v.value;t.gritGain&&(n.grit=Math.min(n.maxGrit,n.grit+t.gritGain)),t.cargoGain&&(n.cargo+=t.cargoGain),t.speedGain&&(n.speed+=t.speedGain),t.luckGain&&(n.luck+=t.luckGain),t.resourceBonus&&(K.value+=t.resourceBonus)},it=t=>{t.type==="camp"?f.value=t.id:(t.type,U())},rt=()=>{G.value="victory",H.value=Gt("lootTrain")},ut=t=>{if(!P.value.has(t.id))return;const e=Z.value,o=n.grit<e;o&&kt({title:"Grit exhausted",description:"Gruntag pushes onward anyway, but the convoy will fail after this move.",variant:"destructive"}),n.grit-=e,R.value+=1,lt(),I.value=t.id,t.visited||(t.visited=!0,V.value+=1),T(`Moved to ${t.type.toUpperCase()} • Cost ${e} grit`),t.resolved||it(t),(n.grit<0||o)&&pt("Gruntag collapses after forcing the convoy forward.")},ct=t=>{t.type!=="start"&&P.value.has(t.id)&&ut(t)},dt=t=>{const e=tt[t];if(!e)return;k.value.push(e),at(e),h.value=null;const o=N.value;o&&(o.resolved=!0,o.type==="vault"&&rt())},F=t=>{if(!f.value)return;t==="grit"?(n.grit=Math.min(n.maxGrit,n.grit+10),T("Camped: +10 grit.")):t==="max"?(n.maxGrit+=2,n.grit+=2,T("Camped: +2 max grit.")):t==="luck"&&(n.luck+=2,T("Camped: +2 luck.")),f.value=null;const e=N.value;e&&!e.resolved&&U()},pt=t=>{z.value=t,G.value="defeat",h.value=null,f.value=null},L=()=>{y.value=[],k.value=[],h.value=null,f.value=null,G.value="map",R.value=0,V.value=1,w.value=["Convoy assembled at the outer station."],n.grit=28,n.maxGrit=28,n.cargo=0,n.speed=1,n.luck=0,K.value=0,nt()};return yt(()=>{L()}),(t,e)=>(r(),i("div",Nt,[s("header",Bt,[s("button",{type:"button",class:"back-button",onClick:e[0]||(e[0]=o=>u(Q).push("/"))},[d(u(xt),{class:"icon"}),e[4]||(e[4]=C(" Back ",-1))]),s("div",Tt,[d(u(St),{class:"icon"}),e[5]||(e[5]=s("div",null,[s("p",{class:"eyebrow"},"Final Expedition"),s("h1",null,"Loot Train")],-1))]),s("button",{type:"button",class:"secondary-button",onClick:L},[d(u(wt),{class:"icon"}),e[6]||(e[6]=C(" Reset Run ",-1))])]),s("section",Lt,[e[7]||(e[7]=s("div",null,[s("p",{class:"eyebrow"},"Deckbuilding Journey"),s("p",null," Guide Gruntag across a sprawling, non-linear tunnel map inspired by FTL. Every stop yields loot cards that grant bonuses each time you travel. Manage your grit—each step costs more than the last. ")],-1)),s("div",At,[d(u(Mt),{class:"icon"}),s("div",null,[s("p",Et,a(u(X).plural),1),s("p",$t,a(H.value),1)])])]),s("section",It,[s("div",Vt,[d(u(W),{class:"icon"}),s("div",null,[e[8]||(e[8]=s("p",{class:"label"},"Grit",-1)),s("p",Dt,a(n.grit)+" / "+a(n.maxGrit),1),s("p",Pt,"Next step cost: "+a(Z.value),1)])]),s("div",Ot,[d(u(J),{class:"icon"}),s("div",null,[e[9]||(e[9]=s("p",{class:"label"},"Convoy Pace",-1)),s("p",Ut,"Speed "+a(n.speed),1),s("p",Ft,"Luck "+a(n.luck),1)])]),s("div",jt,[d(u(Y),{class:"icon"}),s("div",null,[e[10]||(e[10]=s("p",{class:"label"},"Cargo Tally",-1)),s("p",Ht,a(n.cargo),1),s("p",zt,a(k.value.length)+" loot cards collected",1)])])]),s("div",Kt,[s("section",Zt,[s("header",Jt,[e[11]||(e[11]=s("div",null,[s("p",{class:"eyebrow"},"Tunnel Cartography"),s("h2",null,"Choose Your Path")],-1)),d(u(Rt),{class:"icon"})]),s("div",Yt,[(r(),i("svg",Wt,[(r(!0),i(x,null,S(et.value,o=>(r(),i("line",{key:o.id,x1:o.x1,y1:o.y1,x2:o.x2,y2:o.y2},null,8,qt))),128))])),(r(!0),i(x,null,S(y.value,o=>{var l,g,p;return r(),i("button",{key:o.id,type:"button",class:ht(["map-node",[`type-${o.type}`,{visited:o.visited,resolved:o.resolved,reachable:P.value.has(o.id)},{current:((l=N.value)==null?void 0:l.id)===o.id}]]),style:ft({left:`${((g=B.value.get(o.id))==null?void 0:g.x)??0}%`,top:`${((p=B.value.get(o.id))==null?void 0:p.y)??0}%`}),onClick:m=>ct(o)},[s("span",null,a(o.type==="vault"?"✦":o.type==="camp"?"☕":o.type==="loot"?"◇":"S"),1)],14,Qt)}),128))]),s("p",Xt," Steps taken: "+a(R.value)+" • Nodes visited: "+a(V.value)+" / "+a(y.value.length),1)]),s("section",te,[e[15]||(e[15]=s("header",{class:"panel-header"},[s("div",null,[s("p",{class:"eyebrow"},"Journey Log"),s("h2",null,"Bonuses & Notes")])],-1)),s("div",ee,[e[12]||(e[12]=s("p",{class:"summary-title"},"Step Bonuses",-1)),s("ul",null,[s("li",null,"-"+a(v.value.costReduction)+" grit travel cost",1),s("li",null,"+"+a(v.value.gritGain)+" grit after moving",1),s("li",null,"+"+a(v.value.cargoGain)+" cargo • +"+a(v.value.speedGain)+" speed",1),s("li",null,"+"+a(v.value.luckGain)+" luck • +"+a(v.value.resourceBonus)+" seal progress",1)])]),s("div",se,[e[13]||(e[13]=s("p",{class:"summary-title"},"Collected Loot Cards",-1)),k.value.length?(r(),i("ul",ne,[(r(!0),i(x,null,S(k.value,(o,l)=>(r(),i("li",{key:`${o.key}-${l}`},[s("span",ae,a(o.name),1),s("span",le,a(o.rarity)+" • "+a(o.focus),1)]))),128))])):(r(),i("p",oe,"Collect cards to power each step."))]),s("div",ie,[e[14]||(e[14]=s("p",{class:"summary-title"},"Recent Events",-1)),s("ul",null,[(r(!0),i(x,null,S(w.value,o=>(r(),i("li",{key:o},a(o),1))),128))])])])]),h.value?(r(),i("div",re,[s("div",ue,[e[16]||(e[16]=s("header",null,[s("h3",null,"Choose New Loot"),s("p",null,"Each card grants bonuses automatically every step.")],-1)),s("div",ce,[(r(!0),i(x,null,S(h.value,o=>(r(),i("button",{key:o.key,type:"button",class:"draft-card",onClick:l=>dt(o.key)},[s("p",pe,[C(a(o.name)+" ",1),s("span",null,a(o.rarity),1)]),s("p",ve,a(o.description),1),s("p",me,a(o.focus)+" focus",1)],8,de))),128))])])])):E("",!0),f.value?(r(),i("div",ye,[s("div",ge,[e[20]||(e[20]=s("header",null,[s("h3",null,"Campfire Choices"),s("p",null,"Recover before continuing.")],-1)),s("div",he,[s("button",{type:"button",class:"rest-button",onClick:e[1]||(e[1]=o=>F("grit"))},[d(u(W),{class:"icon"}),e[17]||(e[17]=C(" +10 grit ",-1))]),s("button",{type:"button",class:"rest-button",onClick:e[2]||(e[2]=o=>F("max"))},[d(u(Y),{class:"icon"}),e[18]||(e[18]=C(" +2 max grit ",-1))]),s("button",{type:"button",class:"rest-button",onClick:e[3]||(e[3]=o=>F("luck"))},[d(u(J),{class:"icon"}),e[19]||(e[19]=C(" +2 luck ",-1))])])])])):E("",!0),G.value==="victory"?(r(),i("div",fe,[s("div",{class:"overlay-card"},[e[21]||(e[21]=s("header",null,[s("h3",null,"Vault Secured"),s("p",null,"The loot train reaches the inner vault. A seal is awarded!")],-1)),s("button",{type:"button",class:"secondary-button",onClick:L},"Start New Run")])])):E("",!0),G.value==="defeat"?(r(),i("div",ke,[s("div",be,[s("header",null,[e[22]||(e[22]=s("h3",null,"Convoy Lost",-1)),s("p",null,a(z.value),1)]),s("button",{type:"button",class:"secondary-button",onClick:L},"Try Again")])])):E("",!0)]))}}),Te=bt(Ce,[["__scopeId","data-v-7352ecd7"]]);export{Te as default};
